Оптимизация данных в полях типа BLOB
====================================

Это экспериментальный проект по оптимизации данных в полях типа BLOB СУБД Firebird.

Некоторые приложения написаны так что они записывают поля типа BLOB сегментами с небольшим размером.
Есть случаи компоненты доступа ориентируются на метаданные, где зачастую записано что-то вроде

```sql
PIC  BLOB SUB_TYPE 0 SEGMENT SIZE 80
```

В таком случае такие компоненты доступа могут записывать сегментами по 80 байт. Это может негативно отразиться на скорости чтения таких BLOB полей клиентским приложением.

Утилита `blob_opt` позволяет читать данные из таких BLOB полей и 

* перезаписывать их с заданны размером сегмента. Обычно чем больше такой размер тем лучше;
* преобразовывать BLOB поля в потоковые BLOB.

В файле `select.sql` расположен запрос который читает данные из искомой таблицы. Этот запрос должен выбирать два поля: поле первичного ключа и поле типа BLOB. Если в таблице нет первичного ключа или он является составным, то вы можете воспользоваться служебным полем `RDB$DB_KEY`.

Пример содержимого файла `select.sql`:

```sql
select 
  id,
  pic
from t
where pic is not null
```

Вы можете использовать любые фильтры которые ограничат размер выборки. Например, можно использовать функцию OCTETS_LENGTH для отсечки совсем маленьких BLOB.

В файле `modify.sql` расположен модифицирующий запрос, т.е. запрос который пишет содержимое нового BLOB обратно в базу данных.


***
*Важно*

Имена параметров в запросе должны совпадать с именами полей из запроса в `select.sql`.
***

Пример содержимого файла `modify.sql`:

```sql
update t
set pic = :pic
where id = :id
```

Настройки сохраняются в файле `settings.json`.

Исполняемый файл можно скачать по ссылке [blob_optimize.exe](https://github.com/sim1984/blob_opt/releases/download/1.0/blob_optimize.exe)

Примеры файлов с запросами:

* [select.sql](https://github.com/sim1984/blob_opt/releases/download/1.0/select.sql)
* [modify.sql](https://github.com/sim1984/blob_opt/releases/download/1.0/modify.sql)

***
*Важно*

Требуется установленная 64-разрядная библиотека `fbclient.dll`. 
Если библиотека не установлена, то поместите её в каталог с исполняемым файлом.
***
